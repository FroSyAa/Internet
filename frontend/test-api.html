<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #e0e0e0;
        }
        button {
            background: #ff4500;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px 5px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
        }
        button:hover {
            background: #ffa500;
        }
        pre {
            background: #0d0d0d;
            padding: 15px;
            border-radius: 5px;
            border: 2px solid #333;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .success {
            color: #28a745;
        }
        .error {
            color: #dc3545;
        }
        .info {
            color: #ffa500;
        }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç API –º–∞–≥–∞–∑–∏–Ω–∞ –º–æ—Ç–æ—Ü–∏–∫–ª–æ–≤</h1>
    
    <div>
        <button onclick="testAPI()">–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API</button>
        <button onclick="testCategories()">–¢–µ—Å—Ç 2: –ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
        <button onclick="testProducts()">–¢–µ—Å—Ç 3: –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
        <button onclick="testDatabase()">–¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î</button>
    </div>
    
    <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h2>
    <pre id="results">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞...</pre>

    <script>
        const API_URL = '/api';
        
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const className = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';
            results.innerHTML += `<span class="${className}">${message}</span>\n`;
        }
        
        function clear() {
            document.getElementById('results').innerHTML = '';
        }
        
        async function testAPI() {
            clear();
            log('=== –¢–ï–°–¢ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API ===\n', 'info');
            
            try {
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: GET /api', 'info');
                const response = await fetch(`${API_URL}`);
                log(`–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞: ${response.status} ${response.statusText}`, 'info');
                
                const data = await response.json();
                log('–û—Ç–≤–µ—Ç API:', 'success');
                log(JSON.stringify(data, null, 2), 'success');
            } catch (error) {
                log('–û–®–ò–ë–ö–ê: ' + error.message, 'error');
                log('Backend –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.', 'error');
            }
        }
        
        async function testCategories() {
            clear();
            log('=== –¢–ï–°–¢ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π ===\n', 'info');
            
            try {
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: GET /api/products/categories', 'info');
                const response = await fetch(`${API_URL}/products/categories`);
                log(`–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞: ${response.status} ${response.statusText}`, 'info');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const categories = await response.json();
                log('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ:', 'success');
                log(JSON.stringify(categories, null, 2), 'success');
                log(`\n–í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${categories.length}`, 'success');
            } catch (error) {
                log('–û–®–ò–ë–ö–ê: ' + error.message, 'error');
            }
        }
        
        async function testProducts() {
            clear();
            log('=== –¢–ï–°–¢ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ ===\n', 'info');
            
            try {
                log('–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: GET /api/products', 'info');
                const response = await fetch(`${API_URL}/products`);
                log(`–°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞: ${response.status} ${response.statusText}`, 'info');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const products = await response.json();
                log('–¢–æ–≤–∞—Ä—ã –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ:', 'success');
                log(`–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: ${products.length}`, 'success');
                
                if (products.length > 0) {
                    log('\n–ü—Ä–∏–º–µ—Ä –ø–µ—Ä–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞:', 'info');
                    log(JSON.stringify(products[0], null, 2), 'success');
                }
            } catch (error) {
                log('–û–®–ò–ë–ö–ê: ' + error.message, 'error');
            }
        }
        
        async function testDatabase() {
            clear();
            log('=== –¢–ï–°–¢ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î ===\n', 'info');
            
            try {
                log('–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...', 'info');
                const categoriesResponse = await fetch(`${API_URL}/products/categories`);
                const categories = await categoriesResponse.json();
                log(`‚úì –ö–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –ë–î: ${categories.length}`, 'success');
                
                log('\n–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...', 'info');
                const productsResponse = await fetch(`${API_URL}/products`);
                const products = await productsResponse.json();
                log(`‚úì –¢–æ–≤–∞—Ä–æ–≤ –≤ –ë–î: ${products.length}`, 'success');
                
                if (categories.length === 0) {
                    log('\n‚ö† –ü–†–û–ë–õ–ï–ú–ê: –í –ë–î –Ω–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π!', 'error');
                    log('–†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:', 'error');
                    log('docker-compose down -v', 'error');
                    log('docker-compose up -d', 'error');
                }
                
                if (products.length === 0) {
                    log('\n‚ö† –ü–†–û–ë–õ–ï–ú–ê: –í –ë–î –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤!', 'error');
                    log('–†–µ—à–µ–Ω–∏–µ: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (—Å–º. –≤—ã—à–µ)', 'error');
                }
                
                if (categories.length > 0 && products.length > 0) {
                    log('\n‚úì –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!', 'success');
                    log('\n–ö–∞—Ç–µ–≥–æ—Ä–∏–∏:', 'info');
                    categories.forEach(cat => log(`  - ${cat}`, 'info'));
                }
                
            } catch (error) {
                log('–û–®–ò–ë–ö–ê: ' + error.message, 'error');
                log('\n–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:', 'error');
                log('1. Backend –Ω–µ –∑–∞–ø—É—â–µ–Ω', 'error');
                log('2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞', 'error');
                log('3. –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é Docker', 'error');
            }
        }
    </script>
</body>
</html>
